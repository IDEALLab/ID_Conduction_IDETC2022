# ID_Conduction_IDETC2022
Machine learning models (K-Nearest Neighbors and Random Forest) and 2D heat sink topology optimization code associated with our accepted IDETC 2022 paper: "Mean Squared Error may lead you astray when Optimizing your Inverse Design methods."

<img src=ID_conduction.PNG width="400">

## OPTIMAL TOPOLOGY DATA GENERATION

Filename: `hrdge`

Function: Coordinates files used to generate and save optimized topology data.

Filename: `hr_setup.py`

Function: Initializes array for related files.

Filename: `hr_data_gen.py`

Function: Generates and saves optimized topologies in numpy arrays.

Filename: `hr_file_combiner.py`

Function: Combines numpy arrays containing topology data from `hr_data_gen.py` into one numpy array, `hr_data.npy`. It deletes superfluous files generated by `hr_data_gen.py`.

## HYPERPARAMETER OPTIMIZATION 

### Pofmm

Filename: `bernard_experiment_2`

Function: Manages related files. Tests different combinations of hyperparameters using the POFM method. Reports iteration numbers and objectives in numpy arrays: knn_objectives.npy (KNN), rf_objectives (RF), and c_objectives.npy (control).

Filename: `setup_2.py`

Function: Initializes arrays to be used in other POFMM-related files.

Filename: `model_trainer_2.py`

Function: Trains RF and KNN models with selected hyperparameters on data. Uses these models to produce and save predicted topologies as numpy arrays (knn_predictions_2.npy and rf_predictions_2.npy).

Filename: `top_opt_knn_2.py`

Function: Runs optimization process using a KNN prediction as an initialization. Saves iterations and objectives as numpy arrays.

Filename: `top_opt_rf_2.py`

Function: Runs optimization process using a RF prediction as an initialization. Saves iterations and objectives as numpy arrays.

Filename: `top_opt_control_2.py`

Function: Runs optimization process using a constant distribution as an initialization. Saves iterations and objectives as numpy arrays.

Filename: `combiner_2.py`

Function: Combines output arrays from `top_opt_<label>_2.py` files into 3 numpy arrays: `knn_objectives.npy`, `rf_objectives.npy`, and `c_objectives.npy` (control).

### Pmsem

Filename: `pmsem_optimization.py`

Function: Performs PMSEM hyperparameter optimization for RF and KNN models. Saves mean MSE results as numpy arrays.

## MAIN EXPERIMENT

Filename: `bernard_experiment`

Function: NOTE: Needs to be run once for POFMM and again for PMSEM optimized hyperparameters. Manages related files. Tests predictions from KNN and RF models with different hyerparameters as initializations for the optimization process. Saves iterations and objectives as numpy arrays: `knn_trajectories_1n.npy`, `rf_trajectories.npy`, and `c_trajectories.npy` (control).

Filename: `setup.py`

Function: Initializes arrays for other files.

Filename: `model_trainer.py`

Function: Trains models using specified hyperparameters. Saves predicted topologies as a numpy array (`predictions_1n.npy`).

Filename: `top_opt_knn.py`

Function: Runs optimization process using a KNN prediction as an initialization. Saves iterations and objectives as numpy arrays.

Filename: `top_opt_rf.py`

Function: Runs optimization process using a RF prediction as an initialization. Saves iterations and objectives as numpy arrays.

Filename: `top_opt_control.py`

Function: Runs optimization process using a constant distribution as an initialization. Saves iterations and objectives as numpy arrays.

Filename: `combiner.py`

Function: Combines output arrays from `top_opt_<label>.py` files into 3 numpy arrays: `knn_trajectories_1n.npy`, `rf_trajectories.npy`, and `c_trajectories.npy` (control).

## DATA POSTPROCESSING

Filename: 'data_postproc.py'

Function: Plots averaged and normalized results of main experiment.
